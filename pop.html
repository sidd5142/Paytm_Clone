<!DOCTYPE html>
<html ng-app="otpApp">
<head>
    <title>OTP Example</title>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.8.2/angular.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>
</head>
<body ng-controller="otpController">
    <button ng-click="showOTPForm()">Generate OTP</button>
    
    <script>
        var app = angular.module("otpApp", []);
        
        app.controller("otpController", function ($scope) {
            $scope.contactNumber = "";
            $scope.generatedOTP = "";
            
            $scope.showOTPForm = function () {
                Swal.fire({
                    title: 'Enter Contact Number',
                    html: '<input type="text" ng-model="contactNumber">',
                    showCancelButton: true,
                    confirmButtonText: 'Generate OTP',
                    preConfirm: function() {
                        return $scope.generateOTP();
                    }
                }).then(function(result) {
                    if (result.value) {
                        $scope.showOTPPopup();
                    }
                });
            };
            
            $scope.showOTPPopup = function () {
                Swal.fire({
                    title: 'Enter OTP',
                    html: '<input type="text" ng-model="enteredOTP">',
                    showCancelButton: true,
                    confirmButtonText: 'Submit OTP',
                    preConfirm: function() {
                        return $scope.submitOTP();
                    }
                });
            };
            
            $scope.generateOTP = function () {
                // Send a request to the server to generate OTP and handle the response
                // On success, set $scope.generatedOTP to the received OTP
                $scope.generatedOTP = "123456"; // Replace this with the actual OTP
                
                if ($scope.generatedOTP) {
                    return $scope.generatedOTP;
                } else {
                    Swal.showValidationMessage("Failed to generate OTP.");
                }
            };
            
            $scope.submitOTP = function () {
                // Send the contact number and entered OTP to the server and handle the response
                // You can use $scope.contactNumber and $scope.enteredOTP to get the values
                
                // On successful submission, perform the desired action
                if ($scope.enteredOTP === $scope.generatedOTP) {
                    Swal.fire('OTP Verification Successful', 'You can proceed with your action.', 'success');
                } else {
                    Swal.showValidationMessage('Invalid OTP. Please try again.');
                }
            };
        });
    </script>
</body>
</html>
<!-- 



app.controller("otpController", function ($scope, $http) {
    $scope.contactNumber = "";
    $scope.otpverify = "";

    $scope.showOTPForm = function () {
        Swal.fire({
            title: 'Enter Contact Number',
            html: '<input type="text" ng-model="contactNumber">',
            showCancelButton: true,
            confirmButtonText: 'Generate OTP',
            preConfirm: function () {
                return $scope.otp();
            }
        }).then(function (result) {
            if (result.value) {
                $scope.showOTPPopup();
            }
        });
    };

    $scope.showOTPPopup = function () {
        Swal.fire({
            title: 'Enter OTP',
            html: '<input type="text" ng-model="otpverify">',
            showCancelButton: true,
            confirmButtonText: 'Submit OTP',
            preConfirm: function () {
                return $scope.submit();
            }
        });
    };

    $scope.otp = function () {
        if ($scope.contactNumber) {
            var formdata = {
                phone: $scope.contactNumber
            };

            $http.post(ip + 'otp', formdata, {
                withCredentials: true
            })
                .then(function (response) {
                    console.log(response);
                    Swal.fire({
                        position: 'centre',
                        icon: 'success',
                        title: response.data.message,
                        showConfirmButton: false,
                        timer: 1500
                    });
                    $scope.showotp = true;
                })
                .catch(function (error) {
                    console.log(error);
                    Swal.fire({
                        position: 'centre',
                        icon: 'error',
                        title: 'Fields are Empty!!',
                        showConfirmButton: false,
                        timer: 1500
                    });
                });
        } else {
            Swal.fire({
                position: 'centre',
                icon: 'error',
                title: 'Fields are Empty!!',
                showConfirmButton: false,
                timer: 1500
            });
        }
    };

    $scope.submit = function () {
        var number = {
            phone: $scope.contactNumber,
            otp: $scope.otpverify
        };

        $http.post(ip + 'confirm_otp', number, {
            withCredentials: true
        })
            .then(function (response) {
                console.log(response);
                $state.go('Dashboard.BankAccount');
            })
            .catch(function (error) {
                console.log(error);
                Swal.fire({
                    position: 'centre',
                    icon: 'error',
                    title: 'Something went wrong',
                    showConfirmButton: false,
                    timer: 1500
                });
            });
    };
}) -->